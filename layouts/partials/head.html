<head>
  <meta charset="utf-8">
  <title>{{ .Title }} | {{ .Site.Title }}</title>

  {{ "<!-- mobile responsive meta -->" | safeHTML }}
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="description" content="{{ if and .Description .IsPage }}{{ .Summary }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  <meta name="theme-color" content="#ffffff"/>

  {{ if .IsPage }}
  {{ range .Params.authors }}<meta name="author" content="{{ . }}">{{ end }}
  {{ else }}
  {{ with site.Params.author }}<meta name="author" content="{{ . }}">{{ end }}
  {{ end }}

  {{ hugo.Generator }}

  {{ if site.Params.gtag }}
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','{{ site.Params.gtag }}');</script>
  <!-- End Google Tag Manager -->
  {{ end }}

  {{ "<!-- plugins -->" | safeHTML }}
  {{ range $index, $item := site.Params.plugins.css }}
  {{ $style := resources.Get $item.link | minify | fingerprint }}
  <link rel="stylesheet" href="{{ $style.Permalink }}">
  {{ end }}

  {{ "<!-- Main Stylesheet -->" | safeHTML }}

  {{- partial "style" (dict "css" "css/styles.scss" "lazy" true) -}}

  {{- if eq .Type "posts" -}}
  {{- partial "style" (dict "css" "css/page-post.scss" "lazy" true) -}}
  {{- else if eq .Kind "404" -}}
  {{- partial "style" (dict "css" "css/page-404.scss" "lazy" true) -}}
  {{- else if eq .Type "landing-page" -}}
  {{- partial "style" (dict "css" "css/landing-page.scss" "lazy" true) -}}
  {{- else if eq .Section "authors" -}}
  {{- partial "style" (dict "css" "css/page-author.scss" "lazy" true) -}}
  {{- else if or .IsHome (eq .Kind "term") -}}
  {{- partial "style" (dict "css" "css/page-list.scss" "lazy" true) -}}
  {{ end }}

  {{ $paginator := "" }}
  {{- if or .IsHome .IsSection -}}
  {{ $paginator = .Paginate (where (where .Site.RegularPages.ByPublishDate.Reverse "Type" "posts") "Date.Unix" "<" .Date.Unix) }}
  {{- else if eq .Kind "term" -}}
  {{ $paginator = .Paginate .Data.Pages }}
  {{ end }}

  {{ if $paginator }}
  {{ .Scratch.Set "paginator" $paginator }}
  {{ end }}

  {{ if $paginator }}
  {{ if $paginator.HasNext }}
  <link rel="next" href="{{ $paginator.Next.URL | absURL }}" />
  {{end}}
  {{ if $paginator.HasPrev }}
  <link rel="prev" href="{{ $paginator.Prev.URL | absURL }}" />
  {{ end }}
  <link rel="canonical" href="{{ $paginator.URL | absURL }}">
  {{ else }}
  <link rel="canonical" href="{{ .Permalink }}">
  {{ end }}

  {{ if $paginator }}
  {{ if $paginator.HasPrev }}
  <meta name="robots" content="noindex, follow">
  {{ else }}
 	<meta name="robots" content="index, follow">
  {{ end }}
  {{ else }}
  <meta name="robots" content="index, follow">
  {{ end }}

  <link rel="home" href="{{ .Permalink }}"/>
  <link rel="alternate" href="{{ .Permalink }}" hreflang="x-default" />

  {{ range site.Params.preconnect }}
  <link rel=preconnect href="{{ .link }}">
  {{ end }}

  {{ range site.Params.preload }}
  <link rel="preload" href="{{ .link }}" as="{{ .as }}" crossorigin="anonymous">
  {{ end }}

  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" href="{{ `images/appicons/icon-192.png` | absURL }} ">

  {{ "<!--Favicon-->" | safeHTML }}
  <link rel="icon" href="{{ `images/favicon.png` | absURL }}" type="image/png">
  <!-- <link rel="shortcut icon" href="{{ `images/favicon.png` | absURL }} " type="image/png"> -->

  {{ if .OutputFormats.Get "RSS" }}
  {{ with .OutputFormats.Get "RSS" }}
  <link href="{{ site.BaseURL }}index.xml" rel="alternate" type="application/rss+xml" title="{{ $.Site.Title }}" />
  <link href="{{ site.BaseURL }}index.xml" rel="feed" type="application/rss+xml" title="{{ $.Site.Title }}" />
  {{ end }}
  {{ end }}

  {{- partial "schema" . -}}

  {{- partial "opengraph" . -}}
  {{ template "_internal/twitter_cards.html" . }}

  {{ partial "style" (dict "css" "css/consent.scss" "lazy" true) }}

  {{ if hugo.IsProduction }}
  {{- partial "script" (dict "link" "js/ganalytics.js" "asset" true "async" true "buildParams" (dict "gaId" site.Params.google_analytics_id)) -}}
  {{ end }}
</head>
