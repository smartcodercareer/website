{{ $script := .link }}

{{ if .asset }}
{{ $buildConf := (dict "minify" false "target" "esnext") }}

{{ if hugo.IsProduction }}
{{ $buildConf = merge $buildConf (dict "minify" true "sourcemap" "inline") }}
{{ end }}

{{ if .buildParams }}
{{ $buildConf = merge $buildConf (dict "params" .buildParams) }}
{{ end }}

{{ $script = resources.Get $script | js.Build $buildConf }}
{{ end }}

{{ if .asset }}
{{ $script = $script.Permalink }}
{{ end }}

<script src="{{ $script | relURL }}" {{ if .async }}async{{ end }} {{ if .defer }}defer{{ end }} crossorigin="anonymous"></script>